<!DOCTYPE html>
<html>
    <head>
        <title>Power meter</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Bootstrap 5 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
            rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
            crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" 
            crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <p>
                        <h3>Settings</h3>
                        <a href="/">Return to the main page</a>
                    </p>
                    <form action="/settings/set" method="post">
                        <div class="mb-3">
                            <label for="wifi-ssid">WiFi SSID</label>
                            <input type="text" class="form-control" id="wifi-ssid" name="wifi-ssid" required maxlength="50" />  
                        </div>
                        <div class="mb-3">
                            <label for="wifi-pass">WiFi password</label>
                            <input type="text" class="form-control" id="wifi-pass" name="wifi-pass" maxlength="50" />  
                        </div>
                        <div class="mb-3">
                            <label for="mqtt-host">MQTT host</label>
                            <input type="text" class="form-control" id="mqtt-host" name="mqtt-host" maxlength="50" />  
                        </div>
                        <div class="mb-3">
                            <label for="mqtt-username">MQTT username</label>
                            <input type="text" class="form-control" id="mqtt-username" name="mqtt-username" maxlength="50" />  
                        </div>
                        <div class="mb-3">
                            <label for="mqtt-pass">MQTT password</label>
                            <input type="password" class="form-control" id="mqtt-pass" name="mqtt-pass" maxlength="50" />  
                        </div>
                        <div class="mb-3">
                            <label for="mqtt-command">MQTT command topic</label>
                            <input type="text" class="form-control" id="mqtt-command" name="mqtt-command" maxlength="100" />  
                        </div>
                        <div class="mb-3">
                            <label for="mqtt-publish">MQTT publish topic</label>
                            <input type="text" class="form-control" id="mqtt-publish" name="mqtt-publish" maxlength="100" />  
                        </div>
                        <div class="mb-3">
                            <input type="submit" class="btn btn-primary" value="Save changes" />
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            (function (){
                fetch("/api/settings").then(resp => {
                    resp.json().then(data => {
                        document.getElementById("wifi-ssid").value = data["wifi_ssid"]
                        document.getElementById("wifi-pass").value = data["wifi_pass"]
                        document.getElementById("mqtt-host").value = data["mqtt_host"]
                        document.getElementById("mqtt-username").value = data["mqtt_username"]
                        document.getElementById("mqtt-pass").value = data["mqtt_pass"]
                        document.getElementById("mqtt-command").value = data["mqtt_command"]
                        document.getElementById("mqtt-publish").value = data["mqtt_publish"]
                    })
                })
            })()
        </script>
    </body>
</html>